<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Emails - RPG Player</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            padding: 40px 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
            color: #f1c40f;
        }
        
        .subtitle {
            text-align: center;
            color: #bbb;
            margin-bottom: 40px;
        }
        
        .test-section {
            background: #16213e;
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 5px solid;
        }
        
        .test-section.confirm { border-color: #e94560; }
        .test-section.recovery { border-color: #9b59b6; }
        .test-section.check { border-color: #2ecc71; }
        
        .test-section h2 {
            margin-bottom: 15px;
            color: #f1c40f;
        }
        
        .test-steps {
            background: #0f3460;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }
        
        .test-steps li {
            margin: 10px 0;
            padding-left: 10px;
            line-height: 1.6;
        }
        
        .form-group {
            margin: 20px 0;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #bbb;
        }
        
        input {
            width: 100%;
            padding: 12px;
            background: #0f3460;
            border: 2px solid #444;
            border-radius: 8px;
            color: #fff;
            font-size: 16px;
        }
        
        input:focus {
            outline: none;
            border-color: #f1c40f;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            border-radius: 10px;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
            transition: transform 0.2s;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn-confirm { background: linear-gradient(135deg, #e94560 0%, #c0392b 100%); }
        .btn-recovery { background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%); }
        .btn-check { background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%); }
        
        .status {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
            display: none;
        }
        
        .status.success {
            background: rgba(46, 204, 113, 0.2);
            border: 1px solid #2ecc71;
            display: block;
        }
        
        .status.error {
            background: rgba(231, 76, 60, 0.2);
            border: 1px solid #e74c3c;
            display: block;
        }
        
        .status.info {
            background: rgba(52, 152, 219, 0.2);
            border: 1px solid #3498db;
            display: block;
        }
        
        .checklist {
            background: #0f3460;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .checklist-item {
            padding: 10px;
            margin: 5px 0;
            border-left: 3px solid #444;
        }
        
        .checklist-item.done {
            border-left-color: #2ecc71;
            background: rgba(46, 204, 113, 0.1);
        }
        
        .links {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .links a {
            flex: 1;
            padding: 15px;
            background: #0f3460;
            color: #3498db;
            text-decoration: none;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #3498db;
            transition: all 0.3s;
        }
        
        .links a:hover {
            background: #3498db;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìß Teste de Emails</h1>
        <p class="subtitle">Verifique se os templates est√£o funcionando corretamente</p>
        
        <!-- Teste 1: Email de Confirma√ß√£o -->
        <div class="test-section confirm">
            <h2>üéÆ Teste 1: Email de Confirma√ß√£o</h2>
            <p style="color: #bbb; margin-bottom: 20px;">
                Crie uma nova conta e verifique se recebe o email de confirma√ß√£o com o tema RPG.
            </p>
            
            <div class="test-steps">
                <h3 style="color: #e94560; margin-bottom: 15px;">üìã Passos:</h3>
                <ol style="color: #e0e0e0;">
                    <li>Digite um <strong>email REAL</strong> que voc√™ tenha acesso</li>
                    <li>Digite uma senha (m√≠nimo 6 caracteres)</li>
                    <li>Clique em "Criar Conta de Teste"</li>
                    <li>Verifique sua caixa de entrada (e spam!)</li>
                    <li>O email deve ter tema RPG medieval com gradientes</li>
                </ol>
            </div>
            
            <form id="signupForm">
                <div class="form-group">
                    <label>üìß Email:</label>
                    <input type="email" id="signupEmail" placeholder="seu-email@exemplo.com" required>
                </div>
                
                <div class="form-group">
                    <label>üîí Senha:</label>
                    <input type="password" id="signupPassword" placeholder="M√≠nimo 6 caracteres" required>
                </div>
                
                <button type="submit" class="btn-confirm">
                    üéÆ Criar Conta de Teste
                </button>
            </form>
            
            <div id="signupStatus" class="status"></div>
        </div>
        
        <!-- Teste 2: Email de Recupera√ß√£o -->
        <div class="test-section recovery">
            <h2>üîÆ Teste 2: Email de Recupera√ß√£o</h2>
            <p style="color: #bbb; margin-bottom: 20px;">
                Solicite recupera√ß√£o de senha e verifique se recebe o email com tema roxo/m√°gico.
            </p>
            
            <div class="test-steps">
                <h3 style="color: #9b59b6; margin-bottom: 15px;">üìã Passos:</h3>
                <ol style="color: #e0e0e0;">
                    <li>Digite o email de uma conta existente</li>
                    <li>Clique em "Solicitar Recupera√ß√£o"</li>
                    <li>Verifique sua caixa de entrada</li>
                    <li>O email deve ter tema m√°gico com chave üóùÔ∏è</li>
                </ol>
            </div>
            
            <form id="recoveryForm">
                <div class="form-group">
                    <label>üìß Email:</label>
                    <input type="email" id="recoveryEmail" placeholder="email-da-conta@exemplo.com" required>
                </div>
                
                <button type="submit" class="btn-recovery">
                    üîë Solicitar Recupera√ß√£o
                </button>
            </form>
            
            <div id="recoveryStatus" class="status"></div>
        </div>
        
        <!-- Teste 3: Verifica√ß√£o -->
        <div class="test-section check">
            <h2>‚úÖ Checklist de Verifica√ß√£o</h2>
            
            <div class="checklist">
                <h3 style="color: #2ecc71; margin-bottom: 15px;">O que verificar nos emails:</h3>
                
                <div class="checklist-item">
                    <label>
                        <input type="checkbox"> 
                        ‚öîÔ∏è Logo "RPG PLAYER" est√° vis√≠vel
                    </label>
                </div>
                
                <div class="checklist-item">
                    <label>
                        <input type="checkbox">
                        üé® Cores escuras com gradientes (n√£o aparece texto branco em fundo branco)
                    </label>
                </div>
                
                <div class="checklist-item">
                    <label>
                        <input type="checkbox">
                        üîò Bot√£o grande e destacado est√° vis√≠vel
                    </label>
                </div>
                
                <div class="checklist-item">
                    <label>
                        <input type="checkbox">
                        üì± Email fica bonito no celular tamb√©m
                    </label>
                </div>
                
                <div class="checklist-item">
                    <label>
                        <input type="checkbox">
                        üîó Link do bot√£o funciona e redireciona corretamente
                    </label>
                </div>
                
                <div class="checklist-item">
                    <label>
                        <input type="checkbox">
                        ‚ú® Emojis aparecem corretamente (‚öîÔ∏è üõ°Ô∏è üìú etc)
                    </label>
                </div>
                
                <div class="checklist-item">
                    <label>
                        <input type="checkbox">
                        ‚ö†Ô∏è Avisos de seguran√ßa est√£o vis√≠veis
                    </label>
                </div>
            </div>
        </div>
        
        <!-- Links √öteis -->
        <div style="background: #16213e; padding: 30px; border-radius: 15px; margin-top: 40px;">
            <h2 style="color: #f1c40f; text-align: center; margin-bottom: 20px;">üîó Links √öteis</h2>
            
            <div class="links">
                <a href="login.html">üîë P√°gina de Login</a>
                <a href="test-auth.html">üß™ Testes de Auth</a>
                <a href="help-email-confirmation.html">‚ùì Ajuda</a>
            </div>
            
            <div class="links">
                <a href="https://app.supabase.com/project/bifiatkpfmrrnfhvgrpb/auth/email-templates" target="_blank">
                    ‚öôÔ∏è Email Templates (Supabase)
                </a>
                <a href="https://app.supabase.com/project/bifiatkpfmrrnfhvgrpb/auth/users" target="_blank">
                    üë• Ver Usu√°rios (Supabase)
                </a>
            </div>
        </div>
    </div>

    <script type="module">
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.38.0/+esm'
        
        const SUPABASE_URL = 'https://bifiatkpfmrrnfhvgrpb.supabase.co'
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJpZmlhdGtwZm1ycm5maHZncnBiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA0ODM2NTMsImV4cCI6MjA3NjA1OTY1M30.g5S4aT-ml_cgGoJHWudB36EWz-3bonFZW3DEIWNOUAM'
        
        const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY)
        
        // Teste de Cadastro
        document.getElementById('signupForm').addEventListener('submit', async (e) => {
            e.preventDefault()
            
            const email = document.getElementById('signupEmail').value
            const password = document.getElementById('signupPassword').value
            const status = document.getElementById('signupStatus')
            
            status.className = 'status info'
            status.textContent = '‚è≥ Criando conta e enviando email...'
            
            try {
                const { data, error } = await supabase.auth.signUp({
                    email: email,
                    password: password,
                    options: {
                        emailRedirectTo: `${window.location.origin}/onboarding.html`
                    }
                })
                
                if (error) throw error
                
                console.log('‚úÖ Conta criada:', data)
                
                if (data.user && !data.session) {
                    status.className = 'status success'
                    status.innerHTML = `
                        ‚úÖ <strong>Conta criada com sucesso!</strong><br><br>
                        üìß Verifique seu email: <strong>${email}</strong><br>
                        (N√£o esque√ßa de verificar a pasta de spam!)<br><br>
                        ‚è∞ O email pode levar alguns minutos para chegar.
                    `
                } else if (data.session) {
                    status.className = 'status success'
                    status.innerHTML = `
                        ‚úÖ <strong>Conta criada e logado automaticamente!</strong><br><br>
                        ‚ö†Ô∏è Confirma√ß√£o de email est√° DESABILITADA.<br>
                        Voc√™ n√£o receber√° email, mas isso √© normal para desenvolvimento.
                    `
                }
                
            } catch (error) {
                console.error('‚ùå Erro:', error)
                status.className = 'status error'
                
                if (error.message.includes('already registered')) {
                    status.innerHTML = `
                        ‚ö†Ô∏è <strong>Este email j√° tem uma conta!</strong><br><br>
                        Use o teste de recupera√ß√£o abaixo para testar o email de recupera√ß√£o.
                    `
                } else {
                    status.innerHTML = `‚ùå <strong>Erro:</strong> ${error.message}`
                }
            }
        })
        
        // Teste de Recupera√ß√£o
        document.getElementById('recoveryForm').addEventListener('submit', async (e) => {
            e.preventDefault()
            
            const email = document.getElementById('recoveryEmail').value
            const status = document.getElementById('recoveryStatus')
            
            status.className = 'status info'
            status.textContent = '‚è≥ Enviando email de recupera√ß√£o...'
            
            try {
                const { data, error } = await supabase.auth.resetPasswordForEmail(email, {
                    redirectTo: `${window.location.origin}/login.html`
                })
                
                if (error) throw error
                
                console.log('‚úÖ Email de recupera√ß√£o enviado')
                
                status.className = 'status success'
                status.innerHTML = `
                    ‚úÖ <strong>Email de recupera√ß√£o enviado!</strong><br><br>
                    üìß Verifique: <strong>${email}</strong><br>
                    (N√£o esque√ßa de verificar a pasta de spam!)<br><br>
                    üóùÔ∏è Procure por email com tema roxo/m√°gico.<br>
                    ‚è∞ Pode levar alguns minutos para chegar.
                `
                
            } catch (error) {
                console.error('‚ùå Erro:', error)
                status.className = 'status error'
                status.innerHTML = `‚ùå <strong>Erro:</strong> ${error.message}`
            }
        })
        
        // Atualiza checklist
        document.querySelectorAll('.checklist-item input[type="checkbox"]').forEach(checkbox => {
            checkbox.addEventListener('change', (e) => {
                const item = e.target.closest('.checklist-item')
                if (e.target.checked) {
                    item.classList.add('done')
                } else {
                    item.classList.remove('done')
                }
            })
        })
    </script>
</body>
</html>
